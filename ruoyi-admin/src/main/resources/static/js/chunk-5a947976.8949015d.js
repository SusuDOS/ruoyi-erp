(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a947976"],{"13d5":function(t,e,a){"use strict";var r=a("23e7"),n=a("d58f").left,o=a("a640"),l=a("ae40"),i=a("2d00"),c=a("605d"),s=o("reduce"),d=l("reduce",{1:0}),u=!c&&i>79&&i<83;r({target:"Array",proto:!0,forced:!s||!d||u},{reduce:function(t){return n(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"22cb":function(t,e,a){},"2b19":function(t,e,a){var r=a("23e7"),n=a("129f");r({target:"Object",stat:!0},{is:n})},4083:function(t,e,a){"use strict";a.d(e,"f",(function(){return n})),a.d(e,"e",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"a",(function(){return i})),a.d(e,"g",(function(){return c})),a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return d}));var r=a("b775");function n(t){return Object(r["a"])({url:"/erp/product/querPorductByTags",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/erp/product/list",method:"get",params:t})}function l(t){return Object(r["a"])({url:"/erp/product/"+t,method:"get"})}function i(t){return Object(r["a"])({url:"/erp/product",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/erp/product",method:"put",data:t})}function s(t){return Object(r["a"])({url:"/erp/product/"+t,method:"delete"})}function d(t){return Object(r["a"])({url:"/erp/product/export",method:"get",params:t})}},"45a8":function(t,e,a){"use strict";a.d(e,"e",(function(){return n})),a.d(e,"d",(function(){return o})),a.d(e,"a",(function(){return l})),a.d(e,"f",(function(){return i})),a.d(e,"b",(function(){return c})),a.d(e,"c",(function(){return s}));var r=a("b775");function n(t){return Object(r["a"])({url:"/erp/order/list",method:"get",params:t})}function o(t){return Object(r["a"])({url:"/erp/order/"+t,method:"get"})}function l(t){return Object(r["a"])({url:"/erp/order",method:"post",data:t})}function i(t){return Object(r["a"])({url:"/erp/order",method:"put",data:t})}function c(t){return Object(r["a"])({url:"/erp/order/"+t,method:"delete"})}function s(t){return Object(r["a"])({url:"/erp/order/export",method:"get",params:t})}},"4e82":function(t,e,a){"use strict";var r=a("23e7"),n=a("1c0b"),o=a("7b0b"),l=a("d039"),i=a("a640"),c=[],s=c.sort,d=l((function(){c.sort(void 0)})),u=l((function(){c.sort(null)})),p=i("sort"),f=d||!u||!p;r({target:"Array",proto:!0,forced:f},{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),n(t))}})},"746b":function(t,e,a){"use strict";a.d(e,"e",(function(){return n})),a.d(e,"d",(function(){return o})),a.d(e,"a",(function(){return l})),a.d(e,"f",(function(){return i})),a.d(e,"b",(function(){return c})),a.d(e,"c",(function(){return s}));var r=a("b775");function n(t){return Object(r["a"])({url:"/erp/client/list",method:"get",params:t})}function o(t){return Object(r["a"])({url:"/erp/client/"+t,method:"get"})}function l(t){return Object(r["a"])({url:"/erp/client",method:"post",data:t})}function i(t){return Object(r["a"])({url:"/erp/client",method:"put",data:t})}function c(t){return Object(r["a"])({url:"/erp/client/"+t,method:"delete"})}function s(t){return Object(r["a"])({url:"/erp/client/export",method:"get",params:t})}},"9f6e":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.title,visible:t.visible,width:"1200px","append-to-body":""},on:{"update:visible":function(e){t.visible=e},close:function(e){return t.$emit("close")}}},[a("el-card",{attrs:{lass:"box-card"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("基础信息")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t._v("确认")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.readOnly,expression:"readOnly"}],staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t._v("编辑")])],1),a("el-form",{ref:"form",attrs:{inline:!0,model:t.form}},[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"客户姓名",prop:"clientNickname","label-width":"auto"}},[a("el-autocomplete",{staticStyle:{width:"218px"},attrs:{"fetch-suggestions":t.queryClientNameAsync,placeholder:"请输入客户姓名",size:"small","trigger-on-focus":!1,disabled:t.readOnly},on:{select:t.handleSelect},model:{value:t.clientInfo.clientNickname,callback:function(e){t.$set(t.clientInfo,"clientNickname",e)},expression:"clientInfo.clientNickname"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"客户手机号",prop:"clientPhone","label-width":"auto"}},[a("el-input",{staticStyle:{width:"169px"},attrs:{placeholder:"请输入客户手机号",size:"small",disabled:t.readOnly},model:{value:t.clientInfo.clientPhone,callback:function(e){t.$set(t.clientInfo,"clientPhone",e)},expression:"clientInfo.clientPhone"}})],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"送货地址",prop:"shippingAddress","label-width":"auto"}},[a("el-input",{staticStyle:{width:"342px"},attrs:{placeholder:"请输入送货地址",size:"small",max:"100",disabled:t.readOnly},model:{value:t.clientInfo.shippingAddress,callback:function(e){t.$set(t.clientInfo,"shippingAddress",e)},expression:"clientInfo.shippingAddress"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"实付金额",prop:"actualPayment","label-width":"auto"}},[a("el-input",{staticStyle:{width:"125px"},attrs:{size:"small",placeholder:"请输入实付金额",disabled:t.readOnly},model:{value:t.form.actualPayment,callback:function(e){t.$set(t.form,"actualPayment",e)},expression:"form.actualPayment"}})],1)],1)],1),a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"订单名称",prop:"orderName","label-width":"auto"}},[a("el-input",{staticStyle:{width:"218px"},attrs:{placeholder:"请输入订单名称",size:"small",disabled:t.readOnly},model:{value:t.form.orderName,callback:function(e){t.$set(t.form,"orderName",e)},expression:"form.orderName"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"经手人",prop:"handlerName","label-width":"auto"}},[a("el-input",{staticStyle:{width:"169px"},attrs:{size:"small",placeholder:"请输入经手人",disabled:t.readOnly},model:{value:t.form.handlerName,callback:function(e){t.$set(t.form,"handlerName",e)},expression:"form.handlerName"}})],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"订单备注",prop:"remark","label-width":"auto"}},[a("el-input",{staticStyle:{width:"342px"},attrs:{size:"small",placeholder:"请输入备注",disabled:t.readOnly},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticStyle:{display:"flex","flex-direction":"column"},attrs:{label:"开票","label-width":"auto"}},[a("el-switch",{attrs:{disabled:t.readOnly},model:{value:t.form.taxNeed,callback:function(e){t.$set(t.form,"taxNeed",e)},expression:"form.taxNeed"}})],1)],1)],1)],1)],1),a("div",{staticStyle:{"margin-top":"10px"}}),a("transition",{attrs:{name:"fade"}},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:t.form.taxNeed,expression:"form.taxNeed"}],attrs:{lass:"box-card"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("开票信息")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t._v("确认")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.readOnly,expression:"readOnly"}],staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t._v("编辑")])],1),a("el-form",{ref:"form",attrs:{inline:!0,model:t.taxInfo,"label-width":"auto"}},[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"纳税人识别号",prop:"taxpayerId"}},[a("el-input",{staticStyle:{width:"170px"},attrs:{size:"small",placeholder:"请输入纳税人识别号",disabled:t.readOnly},model:{value:t.taxInfo.taxpayerId,callback:function(e){t.$set(t.taxInfo,"taxpayerId",e)},expression:"taxInfo.taxpayerId"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"公司名称",prop:"companyName"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{size:"small",placeholder:"请输入公司名称",disabled:t.readOnly},model:{value:t.taxInfo.companyName,callback:function(e){t.$set(t.taxInfo,"companyName",e)},expression:"taxInfo.companyName"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"公司地址",prop:"companyAddress"}},[a("el-input",{staticStyle:{width:"340px"},attrs:{size:"small",placeholder:"请输入公司地址",disabled:t.readOnly},model:{value:t.taxInfo.companyAddress,callback:function(e){t.$set(t.taxInfo,"companyAddress",e)},expression:"taxInfo.companyAddress"}})],1)],1)],1),a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"联系电话",prop:"contactTel"}},[a("el-input",{staticStyle:{width:"170px"},attrs:{size:"small",placeholder:"请输入联系电话",disabled:t.readOnly},model:{value:t.taxInfo.contactTel,callback:function(e){t.$set(t.taxInfo,"contactTel",e)},expression:"taxInfo.contactTel"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"银行账户",prop:"bankAccount","label-width":"auto"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{size:"small",placeholder:"请输入银行账户",disabled:t.readOnly},model:{value:t.taxInfo.bankAccount,callback:function(e){t.$set(t.taxInfo,"bankAccount",e)},expression:"taxInfo.bankAccount"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"开户行",prop:"depositBank","label-width":"auto"}},[a("el-input",{staticStyle:{width:"340px"},attrs:{size:"small",placeholder:"请输入开户行",disabled:t.readOnly},model:{value:t.taxInfo.depositBank,callback:function(e){t.$set(t.taxInfo,"depositBank",e)},expression:"taxInfo.depositBank"}})],1)],1)],1)],1)],1)],1),a("div",{staticStyle:{"margin-top":"10px"}}),a("el-card",{attrs:{lass:"box-card"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("产品清单")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t._v("确认")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.readOnly,expression:"readOnly"}],staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t._v("编辑")])],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.create||t.edit,expression:"create || edit"}],ref:"form",staticStyle:{display:"flex","justify-content":"space-evenly"},attrs:{"label-position":"left",inline:!0,model:t.productQueryParams}},[a("el-form-item",{attrs:{label:"产品名称",prop:"productName","label-width":"auto"}},[a("el-autocomplete",{staticStyle:{width:"218px"},attrs:{"fetch-suggestions":t.queryProductAsync,placeholder:"支持标签(使用空格分割)","trigger-on-focus":!1,size:"small"},on:{select:t.handleProductNameSelect},model:{value:t.productQueryParams.productName,callback:function(e){t.$set(t.productQueryParams,"productName",e)},expression:"productQueryParams.productName"}})],1),a("el-form-item",{attrs:{label:"产品型号",prop:"productModel","label-width":"auto"}},[a("el-input",{staticStyle:{width:"218px"},attrs:{placeholder:"请输入产品型号",size:"small"},model:{value:t.productQueryParams.productModel,callback:function(e){t.$set(t.productQueryParams,"productModel",e)},expression:"productQueryParams.productModel"}})],1),a("el-form-item",{attrs:{label:"产品数量",prop:"productAmount","label-width":"auto"}},[a("el-input",{staticStyle:{width:"218px"},attrs:{placeholder:"请输入产品数量",size:"small"},model:{value:t.productQueryParams.productAmount,callback:function(e){t.$set(t.productQueryParams,"productAmount",t._n(e))},expression:"productQueryParams.productAmount"}})],1),a("el-form-item",[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["erp:order:add"],expression:"['erp:order:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"small"},on:{click:t.handleAdd}},[t._v("新增")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.productList}},[a("el-table-column",{attrs:{align:"center",label:"名称",prop:"productName"}}),a("el-table-column",{attrs:{align:"center",label:"型号",prop:"productModel"}}),a("el-table-column",{attrs:{align:"center",label:"数量",prop:"productAmount"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.productAmount)+" "+t._s(e.row.productUnit))]}}])}),a("el-table-column",{attrs:{align:"center",label:"金额",prop:"productPrice"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("toFixed")(e.row.productPrice,2)))]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleItemDeleteClick(e.row)}}},[t._v("删除")])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleItemDownClick(e.row)}}},[a("i",{staticClass:"el-icon-arrow-down"})]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleItemUpClick(e.row)}}},[a("i",{staticClass:"el-icon-arrow-up"})])]}}])})],1),a("div",{staticStyle:{"margin-top":"30px"}}),a("h2",[t._v("合计："+t._s(t._f("toFixed")(t.totalPrice,2)))])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.edit||t.create,expression:"edit || create"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.restForm}},[t._v("清 除")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")])],1)],1)},n=[],o=a("c7eb"),l=a("1da1"),i=(a("99af"),a("c740"),a("d81d"),a("13d5"),a("4e82"),a("a434"),a("b680"),a("2b19"),a("d3b7"),a("746b")),c=a("4083"),s=a("45a8"),d=a("2b0e"),u={name:"order-dialog",props:["visible","title","mode","orderId"],data:function(){return{productList:[],form:{taxNeed:!1},clientInfo:{},taxInfo:{},productQueryParams:{productName:"",productAmount:null},loading:!1}},methods:{getOrderDetailInfo:function(t){var e=this;return Object(l["a"])(Object(o["a"])().mark((function a(){var r;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.loading=!0,a.next=3,Object(s["d"])(t);case 3:r=a.sent,e.loading=!1,e.clientInfo=r.data.clientInfo,e.taxInfo=r.data.taxInfo,e.productList=r.data.productList,e.form.taxNeed=1==r.data.taxNeed,e.form.orderName=r.data.orderName,e.form.handlerName=r.data.handlerName,e.form.remark=r.data.remark,e.form.actualPayment=parseFloat(r.data.actualPayment).toFixed(2);case 13:case"end":return a.stop()}}),a)})))()},queryProductAsync:function(t,e){return Object(l["a"])(Object(o["a"])().mark((function a(){var r,n,l;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.split(" ").map((function(t){return new Object({tagName:t})})),a.next=3,Object(c["f"])({tags:r});case 3:n=a.sent,l=n.data.map((function(t){return new Object({value:t.productName,info:t})})),l.sort((function(t,e){return t.info.num-e.info.num})),console.log(l),e(l);case 8:case"end":return a.stop()}}),a)})))()},handleProductNameSelect:function(t){console.log(t),this.productQueryParams.productName=t.value,this.productQueryParams.productModel=t.info.productModel,this.productQueryParams.productAmount=1,this.productQueryParams.info=t.info},queryClientNameAsync:function(t,e){return Object(l["a"])(Object(o["a"])().mark((function a(){var r,n;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["e"])({clientNickname:t});case 2:r=a.sent,n=r.rows.map((function(t){return new Object({value:t.clientNickname,info:t})})),e(n);case 5:case"end":return a.stop()}}),a)})))()},handleSelect:function(t){console.log(t),this.clientInfo.clientNickname=t.value,this.clientInfo.id=t.info.id,this.clientInfo.clientPhone=t.info.clientPhone,this.clientInfo.shippingAddress=t.info.shippingAddress},handleAdd:function(){var t=this.productQueryParams.productAmount,e=Object.assign({},this.productQueryParams.info);this.productList.push(Object.assign(e,{productAmount:t,productPrice:t*e.productPrice}))},handleItemDeleteClick:function(t){var e=this.productList.findIndex((function(e){return Object.is(t,e)}));this.productList.splice(e,1)},handleItemDownClick:function(t){var e=this.productList.findIndex((function(e){return Object.is(t,e)}));if(1!=this.productList.length&&e!=this.productList.length-1){var a=Object.assign({},this.productList[e+1]);d["default"].set(this.productList,e+1,t),d["default"].set(this.productList,e,a)}},handleItemUpClick:function(t){var e=this.productList.findIndex((function(e){return Object.is(t,e)}));if(1!=this.productList.length&&0!=e){var a=Object.assign({},this.productList[e-1]);d["default"].set(this.productList,e-1,t),d["default"].set(this.productList,e,a)}},submitForm:function(){var t=this;return Object(l["a"])(Object(o["a"])().mark((function e(){var a;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,t.mode=1,e.next=4,Object(s["a"])(Object.assign(t.form,{totalPrice:t.totalPrice,clientInfo:t.clientInfo,productList:t.productList,taxInfo:t.taxInfo,taxNeed:t.form.taxNeed?1:0}));case 4:a=e.sent,t.restForm(),t.mode=0,t.loading=!1,console.log(a);case 9:case"end":return e.stop()}}),e)})))()},restForm:function(){this.form={taxNeed:!1},this.clientInfo={},this.taxInfo={},this.productList=[],this.productQueryParams={productName:"",productAmount:null}}},computed:{totalPrice:function(){if(this.productList.length>0)return this.productList.map((function(t){return t.productPrice})).reduce((function(t,e,a,r){return t+e}))},readOnly:function(){return 1==this.mode},edit:function(){return 2==this.mode},create:function(){return 0==this.mode}},watch:{visible:function(t,e){console.log("newVal: ".concat(t,", oldVal: ").concat(e)),1==t&&0==e&&1==this.mode&&this.getOrderDetailInfo(this.orderId)}}},p=u,f=(a("bcc4"),a("2877")),m=Object(f["a"])(p,r,n,!1,null,null,null);e["default"]=m.exports},bcc4:function(t,e,a){"use strict";a("22cb")},d58f:function(t,e,a){var r=a("1c0b"),n=a("7b0b"),o=a("44ad"),l=a("50c4"),i=function(t){return function(e,a,i,c){r(a);var s=n(e),d=o(s),u=l(s.length),p=t?u-1:0,f=t?-1:1;if(i<2)while(1){if(p in d){c=d[p],p+=f;break}if(p+=f,t?p<0:u<=p)throw TypeError("Reduce of empty array with no initial value")}for(;t?p>=0:u>p;p+=f)p in d&&(c=a(c,d[p],p,s));return c}};t.exports={left:i(!1),right:i(!0)}}}]);